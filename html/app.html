<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.2" />
<title>app API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>app</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">import json
import logging
import pandas
from flask import Flask, abort
app = Flask(__name__)

logging.basicConfig(level=logging.DEBUG)


def readcsv(*colonnes):
    &#34;&#34;&#34;
    Cette fonction permet de lire le fichier csv avec pandas.read_csv(),
    sans prendre ne compte les 2 premières lignes avec header=2,
    renommant chaques colonnes avec names=[],
    et permet d&#39;utiliser les colonnes voulues avec usecols=(colonnes).

    This function reads the csv file with pandas.read_csv(),
    without taking into account the first 2 lines with header=2,
    renaming each column with names=[],
    and allows to use the desired columns with usecols=(columns).
    &#34;&#34;&#34;
    logging.debug(f&#34;Utilisation de la fonction readcsv({colonnes})&#34;)
    logging.info(&#34;Lecture du fichier csv&#34;)
    return pandas.read_csv(
        &#39;data.csv&#39;,
        header=2,
        names=[
            &#39;id&#39;,
            &#39;Region&#39;,
            &#39;Year&#39;,
            &#39;Emission&#39;,
            &#39;Value&#39;,
            &#39;Footnote&#39;,
            &#39;Source&#39;],
        usecols=colonnes)


@app.route(&#39;/&#39;)
def hello_world():
    &#34;&#34;&#34;
    Cette fonction permet de vérifier que la route pour l&#39;API
    fonctionne en affichant &#39;Hello, World!&#39;.

    This function checks that the route for the API
    works by displaying &#39;Hello, World!
    &#34;&#34;&#34;
    logging.debug(&#34;Utilisation de la fonction hello_world()&#34;)
    logging.debug(&#34;L&#39;app fonctionne correctement&#34;)
    # utilisé pour tester si l&#39;app fonctionne bien
    return &#39;Hello, World!&#39;


def allcountries():
    &#34;&#34;&#34;
    Cette fonction permet de réduire la liste des pays en supprimant
    les doublons avec set() et de les classer
    par ordre croissant avec sorted().
    On retrouve chaque pays du fichier dans une liste.

    This function allows you to reduce the list of countries by deleting
    the duplicates with set() and to sort them
    in ascending order with sorted().
    Each country in the file is found in a list.
    &#34;&#34;&#34;
    logging.debug(&#34;Utilisation de la fonction allcountries()&#34;)
    df = readcsv(&#39;Region&#39;)
    countries = list(sorted(set(df[&#39;Region&#39;].to_list())))
    logging.debug(countries)
    return countries


def bycountry(country):
    &#34;&#34;&#34;
    Cette fonction permet, en fonction du pays choisi, de récupérer
    l&#39;entrée la plus récente concernant l&#39;émission totale de CO2
    en Milliers de tonnes.

    This function allows, depending on the chosen country, to retrieve
    the most recent entry for total CO2 emissions
    in Thousands of tons.
    &#34;&#34;&#34;
    logging.debug(f&#34;Utilisation de la fonction bycountry({country.title()})&#34;)
    df = readcsv(&#39;Region&#39;, &#39;Year&#39;, &#39;Value&#39;)
    df = df.loc[df[&#39;Region&#39;].isin([country.title()])]
    df = df.sort_values(by=&#39;Year&#39;, ascending=False)
    res = {}
    res[&#34;Country&#34;] = str(df.iloc[0][0])
    res[&#34;Year&#34;] = int(df.iloc[0][1])
    res[&#34;Emissions&#34;] = float(df.iloc[0][2])
    logging.debug(res)
    return json.dumps(res)


@app.route(&#39;/latest_by_country/&lt;country&gt;&#39;)
def by_country(country):
    &#34;&#34;&#34;
    Cette fonction est utilisé si la route &#39;/latest_by_country/&lt;country&gt;&#39;
    est utilisée.
    Si le pays choisi est dans la liste des pays de la fonction allcountries()
    alors on appel la fonction bycountry()
    Sinon un message d&#39;erreur nous préviens que le pays choisi n&#39;est pas dans
    la liste.

    This function is used if the route &#39;/latest_by_country/&lt;country&gt;&#39; is used.
    is used.
    If the selected country is in the list of countries in the allcountries() function
    then we call the function bycountry()
    Otherwise an error message will warn us that the selected country is not in
    the list.
    &#34;&#34;&#34;
    # on veut la valeur la plus récente
    # des emissions totales pour le pays demandé
    logging.debug(f&#34;Utilisation de la fonction by_country({country.title()})&#34;)
    if country.title() in allcountries():
        logging.debug(f&#34;Pays demandé : {country.title()}&#34;)
        return bycountry(country)
    else:
        logging.warning(f&#34;Le pays {country.title()} n&#39;est pas dans la liste&#34;)
        return json.dumps({
            &#34;message&#34;: &#34;Le pays choisi n&#39;est pas dans la liste&#34;})
        abort(404)


def allyears():
    &#34;&#34;&#34;
    Cette fonction permet de réduire la liste des années en supprimant
    les doublons avec set() et de les classer
    par ordre croissant avec sorted().
    On retrouve chaque année du fichier dans une liste.

    This function allows you to reduce the list of years by deleting
    the duplicates with set() and to sort them
    in ascending order with sorted().
    Each year of the file can be found in a list.
    &#34;&#34;&#34;
    logging.debug(&#34;Utilisation de la fonction allyears()&#34;)
    df = readcsv(&#39;Year&#39;)
    years = list(sorted(set(df[&#39;Year&#39;].to_list())))
    logging.debug(years)
    return years


def byyear(year):
    &#34;&#34;&#34;
    Cette fonction permet, en fonction de l&#39;année choisi, de récupérer
    la moyenne des émission totales de CO2 (en Milliers de tonnes)
    au niveau mondial.

    This function allows, depending on the chosen year, to retrieve
    average total CO2 emissions (in Thousands of tons)
    worldwide.
    &#34;&#34;&#34;
    logging.debug(f&#34;Utilisation de la fonction byyear({year})&#34;)
    globalemission = [&#34;Emissions (thousand metric tons of carbon dioxide)&#34;]
    df = readcsv(&#39;Year&#39;, &#39;Value&#39;, &#39;Emission&#39;)
    df = df.loc[df[&#39;Year&#39;].isin([str(year)])]
    df = df.loc[df[&#39;Emission&#39;].isin(globalemission)]
    res = {}
    res[&#34;Year&#34;] = year
    res[&#34;Total&#34;] = round(df[&#39;Value&#39;].mean(), 3)
    logging.debug(res)
    return json.dumps(res)


@app.route(&#39;/average_by_year/&lt;year&gt;&#39;)
def average_for_year(year):
    &#34;&#34;&#34;
    Cette fonction est utilisé si la route &#39;/average_by_year/&lt;year&gt;&#39;
    est utilisée.
    Si l&#39;année choisie est dans la liste des années de la fonction allyears()
    alors on appel la fonction byyear()
    Sinon un message d&#39;erreur nous préviens que l&#39;année choisie n&#39;est pas dans
    la liste.

    This function is used if the route &#39;/average_by_year/&lt;year&gt;&#39;.
    is used.
    If the chosen year is in the list of years in the allyears() function
    then we call the byyear() function
    Otherwise an error message will warn us that the chosen year is not in
    the list.
    &#34;&#34;&#34;
    # on cherche la moyenne des émissions
    # totales au niveau mondial pour une année demandée
    logging.debug(f&#34;Utilisation de la fonction average_for_year({year})&#34;)
    logging.debug(f&#34;Année demandée : {year}&#34;)
    if int(year) in allyears():
        return byyear(year)
    else:
        logging.warning(f&#34;L&#39;année {year} n&#39;est pas dans la liste&#34;)
        return json.dumps({
            &#34;message&#34;: &#34;L&#39;année choisie n&#39;est pas dans la liste&#34;})
        abort(404)


def bypercapita(country):
    &#34;&#34;&#34;
    Cette fonction permet, en fonction du pays choisi,
    d&#39;afficher les émissions de CO2 (en tonnes par habitant)
    par rapport aux différentes années de relevés.

    This function allows, depending on the chosen country,
    display CO2 emissions (in tons per capita)
    in relation to the different survey years.
    &#34;&#34;&#34;
    logging.debug(f&#34;Utilisation de la fonction bypercapita({country.title()})&#34;)
    capita = [&#34;Emissions per capita (metric tons of carbon dioxide)&#34;]
    df = readcsv(&#39;Region&#39;, &#39;Year&#39;, &#39;Emission&#39;, &#39;Value&#39;)
    df = df.loc[df[&#39;Region&#39;].isin([country.title()])]
    df = df.loc[df[&#39;Emission&#39;].isin(capita)]
    res = {}
    nbannee = len(allyears())
    i = 0
    while i &lt; nbannee:
        res[int(df.iloc[i][1])] = float(df.iloc[i][3])
        i += 1
    logging.debug(res)
    return json.dumps(res)


@app.route(&#39;/per_capita/&lt;country&gt;&#39;)
def per_capita(country):
    &#34;&#34;&#34;
    Cette fonction est utilisé si la route &#39;/per_capita/&lt;country&gt;&#39;
    est utilisée.
    Si le pays choisi est dans la liste des pays de la fonction allcountries()
    alors on appel la fonction bypercapita()
    Sinon un message d&#39;erreur nous préviens que le pays choisi n&#39;est pas dans
    la liste.

    This function is used if the route &#39;/per_capita/&lt;country&gt;&#39; is used.
    is used.
    If the selected country is in the list of countries in the allcountries() function
    then we call the function bypercapita()
    Otherwise an error message will warn us that the selected country is not in
    the list.
    &#34;&#34;&#34;
    logging.debug(f&#34;Utilisation de la fonction per_capita({country.title()})&#34;)
    if country.title() in allcountries():
        logging.debug(f&#34;Pays demandé : {country.title()}&#34;)
        return bypercapita(country)
    else:
        logging.warning(f&#34;Le pays {country.title()} n&#39;est pas dans la liste&#34;)
        return json.dumps({
            &#34;message&#34;: &#34;Le pays choisi n&#39;est pas dans la liste&#34;})
        abort(404)


if __name__ == &#34;__main__&#34;:
    app.config.update(ENV=&#34;development&#34;)
    app.run(debug=True)</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="app.allcountries"><code class="name flex">
<span>def <span class="ident">allcountries</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>Cette fonction permet de réduire la liste des pays en supprimant
les doublons avec set() et de les classer
par ordre croissant avec sorted().
On retrouve chaque pays du fichier dans une liste.</p>
<p>This function allows you to reduce the list of countries by deleting
the duplicates with set() and to sort them
in ascending order with sorted().
Each country in the file is found in a list.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def allcountries():
    &#34;&#34;&#34;
    Cette fonction permet de réduire la liste des pays en supprimant
    les doublons avec set() et de les classer
    par ordre croissant avec sorted().
    On retrouve chaque pays du fichier dans une liste.

    This function allows you to reduce the list of countries by deleting
    the duplicates with set() and to sort them
    in ascending order with sorted().
    Each country in the file is found in a list.
    &#34;&#34;&#34;
    logging.debug(&#34;Utilisation de la fonction allcountries()&#34;)
    df = readcsv(&#39;Region&#39;)
    countries = list(sorted(set(df[&#39;Region&#39;].to_list())))
    logging.debug(countries)
    return countries</code></pre>
</details>
</dd>
<dt id="app.allyears"><code class="name flex">
<span>def <span class="ident">allyears</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>Cette fonction permet de réduire la liste des années en supprimant
les doublons avec set() et de les classer
par ordre croissant avec sorted().
On retrouve chaque année du fichier dans une liste.</p>
<p>This function allows you to reduce the list of years by deleting
the duplicates with set() and to sort them
in ascending order with sorted().
Each year of the file can be found in a list.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def allyears():
    &#34;&#34;&#34;
    Cette fonction permet de réduire la liste des années en supprimant
    les doublons avec set() et de les classer
    par ordre croissant avec sorted().
    On retrouve chaque année du fichier dans une liste.

    This function allows you to reduce the list of years by deleting
    the duplicates with set() and to sort them
    in ascending order with sorted().
    Each year of the file can be found in a list.
    &#34;&#34;&#34;
    logging.debug(&#34;Utilisation de la fonction allyears()&#34;)
    df = readcsv(&#39;Year&#39;)
    years = list(sorted(set(df[&#39;Year&#39;].to_list())))
    logging.debug(years)
    return years</code></pre>
</details>
</dd>
<dt id="app.average_for_year"><code class="name flex">
<span>def <span class="ident">average_for_year</span></span>(<span>year)</span>
</code></dt>
<dd>
<div class="desc"><p>Cette fonction est utilisé si la route '/average_by_year/<year>'
est utilisée.
Si l'année choisie est dans la liste des années de la fonction allyears()
alors on appel la fonction byyear()
Sinon un message d'erreur nous préviens que l'année choisie n'est pas dans
la liste.</p>
<p>This function is used if the route '/average_by_year/<year>'.
is used.
If the chosen year is in the list of years in the allyears() function
then we call the byyear() function
Otherwise an error message will warn us that the chosen year is not in
the list.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@app.route(&#39;/average_by_year/&lt;year&gt;&#39;)
def average_for_year(year):
    &#34;&#34;&#34;
    Cette fonction est utilisé si la route &#39;/average_by_year/&lt;year&gt;&#39;
    est utilisée.
    Si l&#39;année choisie est dans la liste des années de la fonction allyears()
    alors on appel la fonction byyear()
    Sinon un message d&#39;erreur nous préviens que l&#39;année choisie n&#39;est pas dans
    la liste.

    This function is used if the route &#39;/average_by_year/&lt;year&gt;&#39;.
    is used.
    If the chosen year is in the list of years in the allyears() function
    then we call the byyear() function
    Otherwise an error message will warn us that the chosen year is not in
    the list.
    &#34;&#34;&#34;
    # on cherche la moyenne des émissions
    # totales au niveau mondial pour une année demandée
    logging.debug(f&#34;Utilisation de la fonction average_for_year({year})&#34;)
    logging.debug(f&#34;Année demandée : {year}&#34;)
    if int(year) in allyears():
        return byyear(year)
    else:
        logging.warning(f&#34;L&#39;année {year} n&#39;est pas dans la liste&#34;)
        return json.dumps({
            &#34;message&#34;: &#34;L&#39;année choisie n&#39;est pas dans la liste&#34;})
        abort(404)</code></pre>
</details>
</dd>
<dt id="app.by_country"><code class="name flex">
<span>def <span class="ident">by_country</span></span>(<span>country)</span>
</code></dt>
<dd>
<div class="desc"><p>Cette fonction est utilisé si la route '/latest_by_country/<country>'
est utilisée.
Si le pays choisi est dans la liste des pays de la fonction allcountries()
alors on appel la fonction bycountry()
Sinon un message d'erreur nous préviens que le pays choisi n'est pas dans
la liste.</p>
<p>This function is used if the route '/latest_by_country/<country>' is used.
is used.
If the selected country is in the list of countries in the allcountries() function
then we call the function bycountry()
Otherwise an error message will warn us that the selected country is not in
the list.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@app.route(&#39;/latest_by_country/&lt;country&gt;&#39;)
def by_country(country):
    &#34;&#34;&#34;
    Cette fonction est utilisé si la route &#39;/latest_by_country/&lt;country&gt;&#39;
    est utilisée.
    Si le pays choisi est dans la liste des pays de la fonction allcountries()
    alors on appel la fonction bycountry()
    Sinon un message d&#39;erreur nous préviens que le pays choisi n&#39;est pas dans
    la liste.

    This function is used if the route &#39;/latest_by_country/&lt;country&gt;&#39; is used.
    is used.
    If the selected country is in the list of countries in the allcountries() function
    then we call the function bycountry()
    Otherwise an error message will warn us that the selected country is not in
    the list.
    &#34;&#34;&#34;
    # on veut la valeur la plus récente
    # des emissions totales pour le pays demandé
    logging.debug(f&#34;Utilisation de la fonction by_country({country.title()})&#34;)
    if country.title() in allcountries():
        logging.debug(f&#34;Pays demandé : {country.title()}&#34;)
        return bycountry(country)
    else:
        logging.warning(f&#34;Le pays {country.title()} n&#39;est pas dans la liste&#34;)
        return json.dumps({
            &#34;message&#34;: &#34;Le pays choisi n&#39;est pas dans la liste&#34;})
        abort(404)</code></pre>
</details>
</dd>
<dt id="app.bycountry"><code class="name flex">
<span>def <span class="ident">bycountry</span></span>(<span>country)</span>
</code></dt>
<dd>
<div class="desc"><p>Cette fonction permet, en fonction du pays choisi, de récupérer
l'entrée la plus récente concernant l'émission totale de CO2
en Milliers de tonnes.</p>
<p>This function allows, depending on the chosen country, to retrieve
the most recent entry for total CO2 emissions
in Thousands of tons.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def bycountry(country):
    &#34;&#34;&#34;
    Cette fonction permet, en fonction du pays choisi, de récupérer
    l&#39;entrée la plus récente concernant l&#39;émission totale de CO2
    en Milliers de tonnes.

    This function allows, depending on the chosen country, to retrieve
    the most recent entry for total CO2 emissions
    in Thousands of tons.
    &#34;&#34;&#34;
    logging.debug(f&#34;Utilisation de la fonction bycountry({country.title()})&#34;)
    df = readcsv(&#39;Region&#39;, &#39;Year&#39;, &#39;Value&#39;)
    df = df.loc[df[&#39;Region&#39;].isin([country.title()])]
    df = df.sort_values(by=&#39;Year&#39;, ascending=False)
    res = {}
    res[&#34;Country&#34;] = str(df.iloc[0][0])
    res[&#34;Year&#34;] = int(df.iloc[0][1])
    res[&#34;Emissions&#34;] = float(df.iloc[0][2])
    logging.debug(res)
    return json.dumps(res)</code></pre>
</details>
</dd>
<dt id="app.bypercapita"><code class="name flex">
<span>def <span class="ident">bypercapita</span></span>(<span>country)</span>
</code></dt>
<dd>
<div class="desc"><p>Cette fonction permet, en fonction du pays choisi,
d'afficher les émissions de CO2 (en tonnes par habitant)
par rapport aux différentes années de relevés.</p>
<p>This function allows, depending on the chosen country,
display CO2 emissions (in tons per capita)
in relation to the different survey years.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def bypercapita(country):
    &#34;&#34;&#34;
    Cette fonction permet, en fonction du pays choisi,
    d&#39;afficher les émissions de CO2 (en tonnes par habitant)
    par rapport aux différentes années de relevés.

    This function allows, depending on the chosen country,
    display CO2 emissions (in tons per capita)
    in relation to the different survey years.
    &#34;&#34;&#34;
    logging.debug(f&#34;Utilisation de la fonction bypercapita({country.title()})&#34;)
    capita = [&#34;Emissions per capita (metric tons of carbon dioxide)&#34;]
    df = readcsv(&#39;Region&#39;, &#39;Year&#39;, &#39;Emission&#39;, &#39;Value&#39;)
    df = df.loc[df[&#39;Region&#39;].isin([country.title()])]
    df = df.loc[df[&#39;Emission&#39;].isin(capita)]
    res = {}
    nbannee = len(allyears())
    i = 0
    while i &lt; nbannee:
        res[int(df.iloc[i][1])] = float(df.iloc[i][3])
        i += 1
    logging.debug(res)
    return json.dumps(res)</code></pre>
</details>
</dd>
<dt id="app.byyear"><code class="name flex">
<span>def <span class="ident">byyear</span></span>(<span>year)</span>
</code></dt>
<dd>
<div class="desc"><p>Cette fonction permet, en fonction de l'année choisi, de récupérer
la moyenne des émission totales de CO2 (en Milliers de tonnes)
au niveau mondial.</p>
<p>This function allows, depending on the chosen year, to retrieve
average total CO2 emissions (in Thousands of tons)
worldwide.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def byyear(year):
    &#34;&#34;&#34;
    Cette fonction permet, en fonction de l&#39;année choisi, de récupérer
    la moyenne des émission totales de CO2 (en Milliers de tonnes)
    au niveau mondial.

    This function allows, depending on the chosen year, to retrieve
    average total CO2 emissions (in Thousands of tons)
    worldwide.
    &#34;&#34;&#34;
    logging.debug(f&#34;Utilisation de la fonction byyear({year})&#34;)
    globalemission = [&#34;Emissions (thousand metric tons of carbon dioxide)&#34;]
    df = readcsv(&#39;Year&#39;, &#39;Value&#39;, &#39;Emission&#39;)
    df = df.loc[df[&#39;Year&#39;].isin([str(year)])]
    df = df.loc[df[&#39;Emission&#39;].isin(globalemission)]
    res = {}
    res[&#34;Year&#34;] = year
    res[&#34;Total&#34;] = round(df[&#39;Value&#39;].mean(), 3)
    logging.debug(res)
    return json.dumps(res)</code></pre>
</details>
</dd>
<dt id="app.hello_world"><code class="name flex">
<span>def <span class="ident">hello_world</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>Cette fonction permet de vérifier que la route pour l'API
fonctionne en affichant 'Hello, World!'.</p>
<p>This function checks that the route for the API
works by displaying 'Hello, World!</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@app.route(&#39;/&#39;)
def hello_world():
    &#34;&#34;&#34;
    Cette fonction permet de vérifier que la route pour l&#39;API
    fonctionne en affichant &#39;Hello, World!&#39;.

    This function checks that the route for the API
    works by displaying &#39;Hello, World!
    &#34;&#34;&#34;
    logging.debug(&#34;Utilisation de la fonction hello_world()&#34;)
    logging.debug(&#34;L&#39;app fonctionne correctement&#34;)
    # utilisé pour tester si l&#39;app fonctionne bien
    return &#39;Hello, World!&#39;</code></pre>
</details>
</dd>
<dt id="app.per_capita"><code class="name flex">
<span>def <span class="ident">per_capita</span></span>(<span>country)</span>
</code></dt>
<dd>
<div class="desc"><p>Cette fonction est utilisé si la route '/per_capita/<country>'
est utilisée.
Si le pays choisi est dans la liste des pays de la fonction allcountries()
alors on appel la fonction bypercapita()
Sinon un message d'erreur nous préviens que le pays choisi n'est pas dans
la liste.</p>
<p>This function is used if the route '/per_capita/<country>' is used.
is used.
If the selected country is in the list of countries in the allcountries() function
then we call the function bypercapita()
Otherwise an error message will warn us that the selected country is not in
the list.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@app.route(&#39;/per_capita/&lt;country&gt;&#39;)
def per_capita(country):
    &#34;&#34;&#34;
    Cette fonction est utilisé si la route &#39;/per_capita/&lt;country&gt;&#39;
    est utilisée.
    Si le pays choisi est dans la liste des pays de la fonction allcountries()
    alors on appel la fonction bypercapita()
    Sinon un message d&#39;erreur nous préviens que le pays choisi n&#39;est pas dans
    la liste.

    This function is used if the route &#39;/per_capita/&lt;country&gt;&#39; is used.
    is used.
    If the selected country is in the list of countries in the allcountries() function
    then we call the function bypercapita()
    Otherwise an error message will warn us that the selected country is not in
    the list.
    &#34;&#34;&#34;
    logging.debug(f&#34;Utilisation de la fonction per_capita({country.title()})&#34;)
    if country.title() in allcountries():
        logging.debug(f&#34;Pays demandé : {country.title()}&#34;)
        return bypercapita(country)
    else:
        logging.warning(f&#34;Le pays {country.title()} n&#39;est pas dans la liste&#34;)
        return json.dumps({
            &#34;message&#34;: &#34;Le pays choisi n&#39;est pas dans la liste&#34;})
        abort(404)</code></pre>
</details>
</dd>
<dt id="app.readcsv"><code class="name flex">
<span>def <span class="ident">readcsv</span></span>(<span>*colonnes)</span>
</code></dt>
<dd>
<div class="desc"><p>Cette fonction permet de lire le fichier csv avec pandas.read_csv(),
sans prendre ne compte les 2 premières lignes avec header=2,
renommant chaques colonnes avec names=[],
et permet d'utiliser les colonnes voulues avec usecols=(colonnes).</p>
<p>This function reads the csv file with pandas.read_csv(),
without taking into account the first 2 lines with header=2,
renaming each column with names=[],
and allows to use the desired columns with usecols=(columns).</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def readcsv(*colonnes):
    &#34;&#34;&#34;
    Cette fonction permet de lire le fichier csv avec pandas.read_csv(),
    sans prendre ne compte les 2 premières lignes avec header=2,
    renommant chaques colonnes avec names=[],
    et permet d&#39;utiliser les colonnes voulues avec usecols=(colonnes).

    This function reads the csv file with pandas.read_csv(),
    without taking into account the first 2 lines with header=2,
    renaming each column with names=[],
    and allows to use the desired columns with usecols=(columns).
    &#34;&#34;&#34;
    logging.debug(f&#34;Utilisation de la fonction readcsv({colonnes})&#34;)
    logging.info(&#34;Lecture du fichier csv&#34;)
    return pandas.read_csv(
        &#39;data.csv&#39;,
        header=2,
        names=[
            &#39;id&#39;,
            &#39;Region&#39;,
            &#39;Year&#39;,
            &#39;Emission&#39;,
            &#39;Value&#39;,
            &#39;Footnote&#39;,
            &#39;Source&#39;],
        usecols=colonnes)</code></pre>
</details>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="two-column">
<li><code><a title="app.allcountries" href="#app.allcountries">allcountries</a></code></li>
<li><code><a title="app.allyears" href="#app.allyears">allyears</a></code></li>
<li><code><a title="app.average_for_year" href="#app.average_for_year">average_for_year</a></code></li>
<li><code><a title="app.by_country" href="#app.by_country">by_country</a></code></li>
<li><code><a title="app.bycountry" href="#app.bycountry">bycountry</a></code></li>
<li><code><a title="app.bypercapita" href="#app.bypercapita">bypercapita</a></code></li>
<li><code><a title="app.byyear" href="#app.byyear">byyear</a></code></li>
<li><code><a title="app.hello_world" href="#app.hello_world">hello_world</a></code></li>
<li><code><a title="app.per_capita" href="#app.per_capita">per_capita</a></code></li>
<li><code><a title="app.readcsv" href="#app.readcsv">readcsv</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.9.2</a>.</p>
</footer>
</body>
</html>